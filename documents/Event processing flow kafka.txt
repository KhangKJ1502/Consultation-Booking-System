ğŸ”„ Luá»“ng xá»­ lÃ½ sá»± kiá»‡n trong há»‡ thá»‘ng Booking:
BookingService
Khi ngÆ°á»i dÃ¹ng táº¡o hoáº·c cáº­p nháº­t má»™t cuá»™c háº¹n, BookingService sáº½ gá»i hÃ m publish event (vÃ­ dá»¥: booking-created, booking-confirmed, ...).

Publisher
Publisher sáº½ Ä‘Ã³ng gÃ³i dá»¯ liá»‡u thÃ nh má»™t sá»± kiá»‡n (event) rá»“i chuyá»ƒn tiáº¿p Ä‘áº¿n Kafka Producer.

Producer
Gá»­i event lÃªn Kafka topic tÆ°Æ¡ng á»©ng (vÃ­ dá»¥: booking-events).

Handler (Consumer)
Má»™t consumer láº¯ng nghe Kafka sáº½ nháº­n event nÃ y vÃ  gá»i HandleMessage(event).

Trong HandleMessage, há»‡ thá»‘ng sáº½ kiá»ƒm tra event_type cá»§a sá»± kiá»‡n nháº­n Ä‘Æ°á»£c.

Dá»±a vÃ o event_type, nÃ³ sáº½ chá»n Ä‘Ãºng NotifyHandler tÆ°Æ¡ng á»©ng.

NotifyHandler
NotifyHandler sáº½ thá»±c thi logic xá»­ lÃ½ tÆ°Æ¡ng á»©ng vá»›i tá»«ng loáº¡i sá»± kiá»‡n, vÃ­ dá»¥:

booking-created â†’ gá»­i thÃ´ng bÃ¡o cho chuyÃªn gia.

booking-confirmed â†’ gá»­i email xÃ¡c nháº­n cho ngÆ°á»i dÃ¹ng.

NotifyHandler â†’ Producer (Kafka)
Sau khi xá»­ lÃ½, náº¿u cáº§n tiáº¿p tá»¥c Ä‘áº©y thÃ´ng bÃ¡o (vÃ­ dá»¥ gá»­i push/email/real-time), NotifyHandler sáº½ tiáº¿p tá»¥c publish event lÃªn Kafka Ä‘á»ƒ cÃ¡c consumer khÃ¡c xá»­ lÃ½.

Consumer â†’ Event Class â†’ Gá»i Ä‘Ãºng handler

Consumer tiáº¿p theo sáº½ nháº­n event nÃ y.

Gá»i event_class.HandleMessage(event).

Dá»±a vÃ o event_type, gá»i Ä‘Ãºng hÃ m xá»­ lÃ½ trong notify_handler.

Cuá»‘i cÃ¹ng gá»i Ä‘áº¿n email service Ä‘á»ƒ gá»­i mail .
